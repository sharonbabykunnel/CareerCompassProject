import{a9 as c,r as g,c as H,b as $,a as B,j as v,f as M,h as F,m as V}from"./index-yZXWRwRE.js";import{h as W}from"./hoist-non-react-statics.cjs-qjBbMXg-.js";import{B as q}from"./url-C7Fa9dY1.js";var G=["sitekey","onChange","theme","type","tabindex","onExpired","onErrored","size","stoken","grecaptcha","badge","hl","isolated"];function k(){return k=Object.assign?Object.assign.bind():function(r){for(var n=1;n<arguments.length;n++){var i=arguments[n];for(var t in i)Object.prototype.hasOwnProperty.call(i,t)&&(r[t]=i[t])}return r},k.apply(this,arguments)}function Y(r,n){if(r==null)return{};var i={},t=Object.keys(r),e,s;for(s=0;s<t.length;s++)e=t[s],!(n.indexOf(e)>=0)&&(i[e]=r[e]);return i}function S(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function J(r,n){r.prototype=Object.create(n.prototype),r.prototype.constructor=r,N(r,n)}function N(r,n){return N=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},N(r,n)}var j=function(r){J(n,r);function n(){var t;return t=r.call(this)||this,t.handleExpired=t.handleExpired.bind(S(t)),t.handleErrored=t.handleErrored.bind(S(t)),t.handleChange=t.handleChange.bind(S(t)),t.handleRecaptchaRef=t.handleRecaptchaRef.bind(S(t)),t}var i=n.prototype;return i.getCaptchaFunction=function(e){return this.props.grecaptcha?this.props.grecaptcha.enterprise?this.props.grecaptcha.enterprise[e]:this.props.grecaptcha[e]:null},i.getValue=function(){var e=this.getCaptchaFunction("getResponse");return e&&this._widgetId!==void 0?e(this._widgetId):null},i.getWidgetId=function(){return this.props.grecaptcha&&this._widgetId!==void 0?this._widgetId:null},i.execute=function(){var e=this.getCaptchaFunction("execute");if(e&&this._widgetId!==void 0)return e(this._widgetId);this._executeRequested=!0},i.executeAsync=function(){var e=this;return new Promise(function(s,b){e.executionResolve=s,e.executionReject=b,e.execute()})},i.reset=function(){var e=this.getCaptchaFunction("reset");e&&this._widgetId!==void 0&&e(this._widgetId)},i.forceReset=function(){var e=this.getCaptchaFunction("reset");e&&e()},i.handleExpired=function(){this.props.onExpired?this.props.onExpired():this.handleChange(null)},i.handleErrored=function(){this.props.onErrored&&this.props.onErrored(),this.executionReject&&(this.executionReject(),delete this.executionResolve,delete this.executionReject)},i.handleChange=function(e){this.props.onChange&&this.props.onChange(e),this.executionResolve&&(this.executionResolve(e),delete this.executionReject,delete this.executionResolve)},i.explicitRender=function(){var e=this.getCaptchaFunction("render");if(e&&this._widgetId===void 0){var s=document.createElement("div");this._widgetId=e(s,{sitekey:this.props.sitekey,callback:this.handleChange,theme:this.props.theme,type:this.props.type,tabindex:this.props.tabindex,"expired-callback":this.handleExpired,"error-callback":this.handleErrored,size:this.props.size,stoken:this.props.stoken,hl:this.props.hl,badge:this.props.badge,isolated:this.props.isolated}),this.captcha.appendChild(s)}this._executeRequested&&this.props.grecaptcha&&this._widgetId!==void 0&&(this._executeRequested=!1,this.execute())},i.componentDidMount=function(){this.explicitRender()},i.componentDidUpdate=function(){this.explicitRender()},i.handleRecaptchaRef=function(e){this.captcha=e},i.render=function(){var e=this.props;e.sitekey,e.onChange,e.theme,e.type,e.tabindex,e.onExpired,e.onErrored,e.size,e.stoken,e.grecaptcha,e.badge,e.hl,e.isolated;var s=Y(e,G);return g.createElement("div",k({},s,{ref:this.handleRecaptchaRef}))},n}(g.Component);j.displayName="ReCAPTCHA";j.propTypes={sitekey:c.string.isRequired,onChange:c.func,grecaptcha:c.object,theme:c.oneOf(["dark","light"]),type:c.oneOf(["image","audio"]),tabindex:c.number,onExpired:c.func,onErrored:c.func,size:c.oneOf(["compact","normal","invisible"]),stoken:c.string,hl:c.string,badge:c.oneOf(["bottomright","bottomleft","inline"]),isolated:c.bool};j.defaultProps={onChange:function(){},theme:"light",type:"image",tabindex:0,size:"normal",badge:"bottomright"};function I(){return I=Object.assign||function(r){for(var n=1;n<arguments.length;n++){var i=arguments[n];for(var t in i)Object.prototype.hasOwnProperty.call(i,t)&&(r[t]=i[t])}return r},I.apply(this,arguments)}function Q(r,n){if(r==null)return{};var i={},t=Object.keys(r),e,s;for(s=0;s<t.length;s++)e=t[s],!(n.indexOf(e)>=0)&&(i[e]=r[e]);return i}function K(r,n){r.prototype=Object.create(n.prototype),r.prototype.constructor=r,r.__proto__=n}var f={},X=0;function Z(r,n){return n=n||{},function(t){var e=t.displayName||t.name||"Component",s=function(w){K(R,w);function R(l,o){var a;return a=w.call(this,l,o)||this,a.state={},a.__scriptURL="",a}var m=R.prototype;return m.asyncScriptLoaderGetScriptLoaderID=function(){return this.__scriptLoaderID||(this.__scriptLoaderID="async-script-loader-"+X++),this.__scriptLoaderID},m.setupScriptURL=function(){return this.__scriptURL=typeof r=="function"?r():r,this.__scriptURL},m.asyncScriptLoaderHandleLoad=function(o){var a=this;this.setState(o,function(){return a.props.asyncScriptOnLoad&&a.props.asyncScriptOnLoad(a.state)})},m.asyncScriptLoaderTriggerOnScriptLoaded=function(){var o=f[this.__scriptURL];if(!o||!o.loaded)throw new Error("Script is not loaded.");for(var a in o.observers)o.observers[a](o);delete window[n.callbackName]},m.componentDidMount=function(){var o=this,a=this.setupScriptURL(),d=this.asyncScriptLoaderGetScriptLoaderID(),p=n,O=p.globalName,u=p.callbackName,y=p.scriptId;if(O&&typeof window[O]<"u"&&(f[a]={loaded:!0,observers:{}}),f[a]){var x=f[a];if(x&&(x.loaded||x.errored)){this.asyncScriptLoaderHandleLoad(x);return}x.observers[d]=function(h){return o.asyncScriptLoaderHandleLoad(h)};return}var E={};E[d]=function(h){return o.asyncScriptLoaderHandleLoad(h)},f[a]={loaded:!1,observers:E};var _=document.createElement("script");_.src=a,_.async=!0;for(var T in n.attributes)_.setAttribute(T,n.attributes[T]);y&&(_.id=y);var U=function(L){if(f[a]){var z=f[a],C=z.observers;for(var D in C)L(C[D])&&delete C[D]}};u&&typeof window<"u"&&(window[u]=function(){return o.asyncScriptLoaderTriggerOnScriptLoaded()}),_.onload=function(){var h=f[a];h&&(h.loaded=!0,U(function(L){return u?!1:(L(h),!0)}))},_.onerror=function(){var h=f[a];h&&(h.errored=!0,U(function(L){return L(h),!0}))},document.body.appendChild(_)},m.componentWillUnmount=function(){var o=this.__scriptURL;if(n.removeOnUnmount===!0)for(var a=document.getElementsByTagName("script"),d=0;d<a.length;d+=1)a[d].src.indexOf(o)>-1&&a[d].parentNode&&a[d].parentNode.removeChild(a[d]);var p=f[o];p&&(delete p.observers[this.asyncScriptLoaderGetScriptLoaderID()],n.removeOnUnmount===!0&&delete f[o])},m.render=function(){var o=n.globalName,a=this.props;a.asyncScriptOnLoad;var d=a.forwardedRef,p=Q(a,["asyncScriptOnLoad","forwardedRef"]);return o&&typeof window<"u"&&(p[o]=typeof window[o]<"u"?window[o]:void 0),p.ref=d,g.createElement(t,p)},R}(g.Component),b=g.forwardRef(function(w,R){return g.createElement(s,I({},w,{forwardedRef:R}))});return b.displayName="AsyncScriptLoader("+e+")",b.propTypes={asyncScriptOnLoad:c.func},W(b,t)}}var P="onloadcallback",ee="grecaptcha";function A(){return typeof window<"u"&&window.recaptchaOptions||{}}function te(){var r=A(),n=r.useRecaptchaNet?"recaptcha.net":"www.google.com";return r.enterprise?"https://"+n+"/recaptcha/enterprise.js?onload="+P+"&render=explicit":"https://"+n+"/recaptcha/api.js?onload="+P+"&render=explicit"}const re=Z(te,{callbackName:P,globalName:ee,attributes:A().nonce?{nonce:A().nonce}:{}})(j),oe=()=>{const r=H(),n=$(),[i,t]=g.useState(""),[e,s]=g.useState(null),[b,w]=g.useState(""),[R,m]=g.useState("border-gray-300"),l=n.state.uid,o=g.useRef(),a=B(),d=u=>{s(u)},p=async()=>{var u;try{const y=await M.post(`${q}/resendOTP`,{uid:l});n.state.otp=(u=y.data)==null?void 0:u.otp}catch(y){console.error(y)}},O=async u=>{var y;if(u.preventDefault(),o.current.reset(),i===((y=n.state)==null?void 0:y.otp)){const x=await F.post("/verify",{isVerified:!0,captcha:e,uid:l},{withCredentials:!0});if(localStorage.setItem("accessToken",x.data.accessToken),x.status===200){const E=await F.get("/user",{withCredentials:!0});r(V({...E.data})),a("/home")}}else w("Invalid OTP. Please try again."),m("border-red-500"),setTimeout(()=>{w(""),m("border-gray-300")},5e3)};return v.jsx("div",{style:{backgroundImage:"url(https://firebasestorage.googleapis.com/v0/b/careercompass-a9b5b.appspot.com/o/login.png?alt=media&token=9dd55b7d-3cf1-46e1-8c92-f447e8630b08)"},className:"h-screen bg-cover bg-center flex items-center justify-center",children:v.jsx("div",{className:"bg-user h-[90%] w-[90%] rounded-xl flex items-center justify-center",children:v.jsx("div",{className:"bg-white h-[95%] w-[97%] rounded-xl",children:v.jsxs("div",{className:"flex flex-col flex-shrink items-center mt-10 ",children:[v.jsx("img",{src:"https://firebasestorage.googleapis.com/v0/b/careercompass-a9b5b.appspot.com/o/logo1.png?alt=media&token=9dd55b7d-3cf1-46e1-8c92-f447e8630b08",className:"w-[30%]"}),v.jsx("input",{type:"text",value:i,placeholder:"Enter OTP",className:`border ${R} m-16 p-2 mb-2 w-[50%]`,onChange:u=>t(u.target.value)}),b&&v.jsx("span",{className:"text-red-500 text-sm mb-2",children:b}),v.jsx("span",{onClick:p,className:"ml-[-40%] text-gray-400 w-40m text-xs",children:"Resend OTP"}),v.jsx(re,{sitekey:"6LfL6f8pAAAAAEYFzYQJUXL3k8Qw7xYUvyTJjtd5",onChange:d,className:"m-16",ref:o}),v.jsx("button",{className:"bg-user rounded w-[50%] m-2 p-2 text-white",onClick:O,children:"Verify"})]})})})})};export{oe as default};
