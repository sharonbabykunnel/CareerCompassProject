import{u as J,a as T,T as B,U as F,j as e,M as I}from"./index-tHbs8s1P.js";import{r as x}from"./vendor-DoS0LqYF.js";import{a as A}from"./index-D4NhA3_c.js";import{u as P}from"./formik.esm-08AmrUP1.js";import{S as V}from"./popup-CoJ1F_Xs.js";import{e as R,p as q}from"./profileService-N1kCdphw.js";import{X as z}from"./x-CraZlvt7.js";const H=({closeEditModal:m,isEditModalOpen:f,newExp:p,selectedExperience:a,setExpLoading:h,setExperiences:b})=>{const k=J(i=>i.presisted.user),y=T(),[u,j]=x.useState(""),g={position:"",company:"",startDate:"",endDate:null,currentJob:!1,description:"",achievments:"",city:"",state:"",country:"",employmentType:"",skills:[]},{handleChange:n,handleBlur:r,values:s,errors:t,touched:l,handleSubmit:C,setValues:c,setFieldValue:v}=P({initialValues:g,validationSchema:A,onSubmit:async(i,d)=>{try{m(),h(!0);let o;if(!p)o=await R(a._id,a.userId,i),y(B(o.data));else{o=await q(k.uid,i);const N=o.data;b&&b(S=>[...S,N]),y(F(N)),V("Experience added")}d.resetForm()}catch(o){Failed(o.response.data.message?o.response.data.message:o.message)}finally{h(!1)}}});x.useEffect(()=>{c(a?{position:a.position,company:a.company,startDate:a.startDate,endDate:a.endDate,currentJob:a.currentJob,description:a.description,achievments:a.achievments,employmentType:a.employmentType,city:a.city,state:a.state,country:a.country,skills:a.skills}:{position:"",company:"",startDate:"",endDate:null,currentJob:!1,description:"",achievments:"",employmentType:"",city:"",state:"",country:"",skills:[]})},[a,c]),x.useEffect(()=>{s.currentJob&&v("endDate",null)},[s.currentJob,v]);const D=()=>{s.skills.length<5&&u.trim()!==""&&(c({...s,skills:[...s.skills,u.trim()]}),j(""))},w=i=>{c({...s,skills:s.skills.filter(d=>d!==i)})};return e.jsx("div",{children:e.jsx(I,{isOpen:f,onRequestClose:m,className:"fixed inset-0 flex items-center justify-center z-50 mt-[80px]",overlayClassName:"fixed inset-0 bg-black bg-opacity-75",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg w-full max-w-lg mx-auto h-[80vh]  ",children:[e.jsxs("div",{className:"flex justify-between   ",children:[e.jsxs("h2",{className:"text-2xl font-semibold mb-4",children:[p?"Add":"Edit"," Experience"]}),e.jsx(z,{onClick:m})]}),e.jsx("form",{onSubmit:C,children:e.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-10 h-[60vh] overflow-auto scrollbar-hide",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block mb-2",children:"Position"}),e.jsx("input",{type:"text",name:"position",value:s.position,onChange:n,onBlur:r,className:"w-full p-2 border rounded"}),t.position&&l.position&&e.jsx("div",{className:"text-red-500 text-sm",children:t.position})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-2",children:"Company Name"}),e.jsx("input",{type:"text",name:"company",value:s.company,onChange:n,onBlur:r,className:"w-full p-2 border rounded"}),t.company&&l.company&&e.jsx("div",{className:"text-red-500 text-sm",children:t.company})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-2",children:"City"}),e.jsx("input",{type:"text",name:"city",value:s.city,onChange:n,onBlur:r,className:"w-full p-2 border rounded"}),t.city&&l.city&&e.jsx("div",{className:"text-red-500 text-sm",children:t.city})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-2",children:"State"}),e.jsx("input",{type:"text",name:"state",value:s.state,onChange:n,onBlur:r,className:"w-full p-2 border rounded"}),t.state&&l.state&&e.jsx("div",{className:"text-red-500 text-sm",children:t.state})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-2",children:"Country"}),e.jsx("input",{type:"text",name:"country",value:s.country,onChange:n,onBlur:r,className:"w-full p-2 border rounded"}),t.country&&l.country&&e.jsx("div",{className:"text-red-500 text-sm",children:t.country})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-2",children:"Start Date"}),e.jsx("input",{type:"date",name:"startDate",value:s.startDate.split("T")[0],onChange:n,onBlur:r,className:"w-full p-2 border rounded"}),t.startDate&&l.startDate&&e.jsx("div",{className:"text-red-500 text-sm",children:t.startDate})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-2",children:"End Date"}),e.jsx("input",{type:"date",name:"endDate",value:s.endDate?s.endDate.split("T")[0]:"",onChange:n,onBlur:r,className:`w-full p-2 border rounded ${s.currentJob?"bg-gray-200":""}`,disabled:s.currentJob}),t.endDate&&l.endDate&&e.jsx("div",{className:"text-red-500 text-sm",children:t.endDate})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("label",{className:"",children:"Current Job"}),e.jsx("input",{type:"checkbox",name:"currentJob",checked:s.currentJob,value:s.currentJob,onChange:n,onBlur:r,className:"w-10  border  rounded"}),t.currentJob&&l.currentJob&&e.jsx("div",{className:"text-red-500 text-sm",children:t.currentJob})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-2",children:"Achievements"}),e.jsx("textarea",{type:"text",name:"achievments",value:s.achievments,onChange:n,onBlur:r,className:"w-full p-2 border rounded"}),t.achievments&&l.achievments&&e.jsx("div",{className:"text-red-500 text-sm",children:t.achievments})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-2",children:"Employment Type"}),e.jsxs("select",{name:"employmentType",value:s.employmentType,onChange:n,onBlur:r,className:"w-full p-2 border rounded",children:[e.jsx("option",{value:"",label:"Select employment type"}),e.jsx("option",{value:"Full-time",label:"Full-time"}),e.jsx("option",{value:"Part-time",label:"Part-time"}),e.jsx("option",{value:"Contract",label:"Contract"}),e.jsx("option",{value:"Internship",label:"Internship"}),e.jsx("option",{value:"Freelance",label:"Freelance"})]}),t.employmentType&&l.employmentType&&e.jsx("div",{className:"text-red-500 text-sm",children:t.employmentType})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-2",children:"Description"}),e.jsx("textarea",{type:"text",name:"description",value:s.description,onChange:n,onBlur:r,className:"w-full p-2 border rounded h-40"}),t.description&&l.description&&e.jsx("div",{className:"text-red-500 text-sm",children:t.description})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-2",children:"Skills (max 5)"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"text",value:u,onChange:i=>j(i.target.value),className:"w-full p-2 border rounded",placeholder:"Enter a skill"}),e.jsx("button",{type:"button",onClick:D,disabled:s.skills.length>=5,className:"ml-2 px-4 py-2 bg-blue-500 text-white rounded disabled:bg-gray-300",children:"Add"})]}),e.jsx("div",{className:"mt-2 flex flex-wrap",children:s.skills.map((i,d)=>e.jsxs("span",{className:"bg-gray-200 px-2 py-1 rounded m-1 flex items-center",children:[i,e.jsx("button",{type:"button",onClick:()=>w(i),className:"ml-2 text-red-500",children:"Ã—"})]},d))}),t.skills&&l.skills&&e.jsx("div",{className:"text-red-500 text-sm",children:t.skills})]}),e.jsx("div",{className:"flex justify-end space-x-2 mt-4",children:e.jsx("button",{type:"submit",className:"text-blue-500 m-4 hover:text-blue-900",children:"Save"})})]})})]})})})};export{H as E};
