import{a as Ge,d as i,W as Je,j as e,M as P,X as Ke,Y as xe,A as Ze,C as Qe}from"./index-DWYqhuEo.js";import{r as l}from"./vendor-DoS0LqYF.js";import{A as Ue,C as De,a as es,S as ss}from"./SearchBar-CDwK7Txt.js";import{S as g,F as h}from"./popup-C9_MHP4v.js";import{E as as}from"./ellipsis-CkcWGRsJ.js";import{X as _}from"./x-D4euQxbN.js";const ds=({post:s,user:o,currentUserId:c,index:r,pindex:n,updateQuerryLike:fe,updateQueryComment:$,updateQuerrySave:ue,updateCommentReplay:ge,userDetails:d,updatePostList:j,filter:L,removeRepost:E,updatePostCommentLike:je})=>{var K,Z,Q,U,D,ee,se,ae,te,le,ne,ce,ie,oe,re,de,me,he;const x=Ge(),[y,ve]=l.useState(!1),[v,w]=l.useState(0),[u,F]=l.useState((K=s==null?void 0:s.likes)==null?void 0:K.includes(c)),[k,z]=l.useState(""),[A,be]=l.useState(!1),[ye,M]=l.useState(!1),[we,N]=l.useState(!1),[b,ke]=l.useState((Z=s==null?void 0:s.saved)==null?void 0:Z.includes(c)),[C,B]=l.useState([]),p=l.useRef(),[H,Ne]=l.useState(""),[f,X]=l.useState([]),[q,I]=l.useState(""),[Ce,T]=l.useState(!1),[V,W]=l.useState(""),[pe,Y]=l.useState(!1),[Se,G]=l.useState([]),J=async a=>{const t=await i.get(`/post/like/likedUsers/${a}`);G(t.data[0]),Y(!0)},Re=()=>{Y(!1),G([])};l.useEffect(()=>{const a=t=>{p.current&&!p.current.contains(t.target)&&N(!1)};return document.addEventListener("mousedown",a),()=>document.addEventListener("mousedown",a)});const Oe=async(a,t,m,O)=>{let Ye={...(await i.post("/comment/addReply",{text:a,post:m,user:o.uid,mention:t})).data,user:d};n!=null&&ge({pindex:n,index:r,cindex:O,currComment:Ye})},S=()=>{M(!1)},Pe=async()=>{try{await i.post("/comment/post",{text:k,post:s==null?void 0:s.uid,user:c});let a={post:s==null?void 0:s.uid,text:k,user:d,likes:[],status:"active"};n!=null?$(n,r,[a]):x(Ke({index:r,currentComment:a})),z("")}catch(a){console.error(a)}},_e=l.useCallback(async(a,t,m)=>{try{await i.post("/comment/like",{user:d==null?void 0:d.uid,comment:a}),n!=null&&je(n,r,m,d==null?void 0:d.uid),x(Je({user:d==null?void 0:d.uid,comment:a,index:r,ind:t}))}catch(O){console.error(O)}},[o==null?void 0:o.uid,s]),$e=a=>{z(a)},Le=()=>{N(!0)},Ee=async()=>{try{const a=await i.delete("/post/delete?post="+(s==null?void 0:s.uid));g("Poste deleted"),n!=null?j(n,r):x(xe(a.data.deleted))}catch(a){h(a.response.data.message?a.response.data.message:a.message)}},Fe=async()=>{try{const a=await i.patch("/post/hide?post="+(s==null?void 0:s.uid));n!=null?j(n,r):x(xe(a.data.hided))}catch(a){h(a.response.data.message?a.response.data.message:a.message)}},ze=async()=>{try{(await i.patch(`/post/reportPost/${s.uid}`,{reason:V,user:c})).data.modified?(j(n,r),g("Reported")):h("Allready Reported"),R(),W("")}catch(a){h(a.message)}},Ae=()=>{try{T(!0),N(!1)}catch(a){h(a.message)}},Me=async()=>{try{(await i.patch(`/post/notInterest/${s.uid}/${c}`)).data.modifiedCount&&(j(n,r),g("Removed"))}catch(a){h(a.message)}},Be=async()=>{F(!u);try{await i.post("/post/like",{postId:s==null?void 0:s._id,userId:c}),n!=null?fe(n,r,c,u):x(Ze({index:r,userId:c,isLiked:u}))}catch{F(!u)}},He=async()=>{M(!0);const a=await i.get("/connection/"+c);B(a.data)},Xe=async()=>{(await i.post(`/chat/post/share/${c}`,{selected:f,post:s._id,caption:q})).data&&(g("Shared post"),I(""),S())},qe=async()=>{var t;(t=(await i.post(`/post/repost/${c}`,{post:s._id})).data)!=null&&t.modified?g("Reposted"):h("Allready Posted")},Ie=async()=>{const a=await i.get(`/connection/connection/search/${c}?value=${H}`);B(a.data)},R=()=>{T(!1)},Te=async()=>{try{ke(!b),await i.post("/post/save",{user:c,post:s==null?void 0:s.uid}),L&&L(s._id),n!=null?ue(n,r,b,c):x(Qe({index:r,user:c,isSaved:b}))}catch(a){console.error(a)}},Ve=async()=>{const a=await i.get(`/comment/getComments/${s.uid}`);n!=null&&$(n,r,a.data),be(!A)},We=a=>{const t=f.includes(a);X(t?f.filter(m=>m!=a):[...f,a])};return e.jsxs("div",{className:` col-start-2 col-end-4 mt-4 p-4 rounded-xl ${s!=null&&s.isBlocked?"bg-red-100":"bg-white"}`,children:[e.jsx("div",{}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between m-4",children:[e.jsxs("div",{className:"flex items-center gap-4 relative",children:[e.jsx("img",{src:(o==null?void 0:o.profilePhoto)||"https://cdn-icons-png.flaticon.com/128/3059/3059518.png",alt:"",className:"w-10 h-10 rounded-full"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl",children:o==null?void 0:o.name}),e.jsx("p",{className:" text-xs",children:o==null?void 0:o.position})]})]}),we?e.jsx("div",{ref:p,className:" right-0 z-[1] mt-2 w-48 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5",children:e.jsx("div",{className:"py-1",role:"menu","aria-orientation":"vertical","aria-labelledby":"options-menu",children:o.uid===c?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:Fe,className:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 w-full text-left",role:"menuitem",children:"Hide Post"}),e.jsx("button",{onClick:Ee,className:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 w-full text-left",role:"menuitem",children:"Delete Post"})]}):e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>Ae(),className:" px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 w-full text-left",role:"menuitem",children:"Report Post"}),e.jsx("button",{onClick:()=>Me(),className:" px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 w-full text-left",role:"menuitem",children:"Not Intrested"})]})})}):e.jsx("div",{className:"relative ",onClick:Le,children:e.jsx(as,{})})]}),e.jsxs("p",{className:"text-gray-600 mb-2 ",children:[y?(Q=s==null?void 0:s.content)==null?void 0:Q.text:`${(D=(U=s==null?void 0:s.content)==null?void 0:U.text)==null?void 0:D.slice(0,100)}`,((se=(ee=s==null?void 0:s.content)==null?void 0:ee.text)==null?void 0:se.length)>50&&e.jsx("button",{onClick:()=>ve(!y),className:"text-blue-500 ml-2 text-sm",children:y?"Read Less":"Read More"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{children:(le=(te=(ae=s==null?void 0:s.files)==null?void 0:ae[v].split("/"))==null?void 0:te[7])!=null&&le.includes(".mp4")?e.jsx("video",{src:(ne=s==null?void 0:s.files)==null?void 0:ne[v],controls:!0,className:"w-full h-auto"}):e.jsx("img",{src:(ce=s==null?void 0:s.files)==null?void 0:ce[v],alt:"",className:"w-full h-auto"})}),e.jsx("div",{className:"flex justify-center mt-2",children:(ie=s==null?void 0:s.files)==null?void 0:ie.map((a,t)=>e.jsx("div",{className:`h-2 w-2 rounded-full mx-1 ${t===v?"bg-blue-500":"bg-gray-300"}`,onClick:()=>w(t)},t))}),((oe=s==null?void 0:s.files)==null?void 0:oe.length)>1&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>w(a=>{var t,m;return(a-1+((t=s==null?void 0:s.files)==null?void 0:t.length))%((m=s==null?void 0:s.files)==null?void 0:m.length)}),className:"absolute left-0 top-1/2 transform -translate-y-1/2 bg-black bg-opacity-50 text-white p-2 rounded-r",children:"<"}),e.jsx("button",{onClick:()=>w(a=>{var t;return(a+1)%((t=s==null?void 0:s.files)==null?void 0:t.length)}),className:"absolute right-0 top-1/2 transform -translate-y-1/2 bg-black bg-opacity-50 text-white p-2 rounded-l",children:">"})]})]})]}),e.jsxs("div",{className:"flex justify-between m-4 mb-2",children:[e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx("img",{onClick:()=>Be(),src:u?"https://cdn-icons-png.flaticon.com/128/739/739231.png":"https://cdn-icons-png.flaticon.com/128/126/126473.png",alt:"likes",className:"h-6"}),e.jsx("div",{onClick:()=>J(s.uid),children:e.jsx(Ue,{numPeople:s.likes.length,avatar:s.likedBy})}),e.jsx(P,{isOpen:pe,className:"fixed inset-0 flex items-center justify-center z-20 mt-[80px]",overlayClassName:"fixed inset-0 bg-black bg-opacity-75",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg  shadow-lg w-full z-30 max-w-lg mx-auto h-[80vh] overflow-auto scrollbar-hide",children:[e.jsxs("div",{className:"flex justify-between   ",children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"Liked by"}),e.jsx(_,{onClick:Re})]}),e.jsx("div",{}),e.jsx("div",{className:"h-[50vh] my-2 overflow-auto scrollbar-hide rounded-t-lg ",children:e.jsx("div",{className:"rounded shadow",children:(re=Se.users)==null?void 0:re.map((a,t)=>e.jsx("div",{className:"flex items-center justify-between 'bg-lite_user'  p-4 ",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("img",{src:a.profilePhoto||"https://cdn-icons-png.flaticon.com/128/3059/3059518.png",alt:"",className:"w-16 h-16 rounded-full mr-4"}),e.jsxs("div",{children:[e.jsx("h2",{className:"font-bold",children:a.name}),e.jsx("div",{className:"flex items-center text-xs text-gray-500 mt-1",children:e.jsx("span",{children:a==null?void 0:a.about})})]})]})},a._id))})})]})})]}),e.jsxs("div",{children:[e.jsx("img",{onClick:Ve,src:"https://cdn-icons-png.flaticon.com/128/1380/1380338.png",alt:"",className:"h-6"}),((de=s==null?void 0:s.commentsCount)==null?void 0:de.length)===0?"":(me=s==null?void 0:s.commentsCount)==null?void 0:me.length]}),e.jsx("div",{children:E?e.jsx(De,{onClick:()=>E(s.uid)}):e.jsx("img",{onClick:qe,src:"https://cdn-icons-png.flaticon.com/128/2734/2734827.png",alt:"",className:"h-6"})}),e.jsx("div",{children:e.jsx("img",{onClick:He,src:"https://cdn-icons-png.flaticon.com/128/3024/3024593.png",alt:"",className:"h-6"})}),e.jsxs("div",{children:[e.jsx("img",{onClick:Te,src:b?"https://cdn-icons-png.flaticon.com/128/102/102279.png":"https://cdn-icons-png.flaticon.com/128/5662/5662990.png",alt:"",className:"h-6"}),((he=s==null?void 0:s.saved)==null?void 0:he.length)||0]})]}),A&&e.jsx(es,{showLikedUsers:J,src:d==null?void 0:d.profilePhoto,value:k,setValue:a=>$e(a),post:Pe,comment:s==null?void 0:s.comments,likeComment:_e,handlePostReply:Oe}),e.jsx(P,{isOpen:ye,onRequestClose:S,className:"fixed inset-0 flex items-center justify-center z-50 mt-[80px]",overlayClassName:"fixed inset-0 bg-black bg-opacity-75",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg w-full max-w-lg mx-auto h-[80vh] overflow-auto scrollbar-hide",children:[e.jsxs("div",{className:"flex justify-between   ",children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"Share"}),e.jsx(_,{onClick:S})]}),e.jsx("div",{children:e.jsx(ss,{searchFun:Ie,search:H,setSearch:Ne})}),e.jsx("div",{className:"h-[50vh] my-2 overflow-auto scrollbar-hide rounded-t-lg ",children:e.jsx("div",{className:"rounded shadow",children:C==null?void 0:C.map(a=>{var t;return e.jsxs("div",{className:`flex items-center justify-between ${f.includes(a.otherUser.uid)?"bg-lite_user":"bg-white "} p-4 `,children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("img",{src:a.otherUser.profilePhoto||"https://cdn-icons-png.flaticon.com/128/3059/3059518.png",alt:a.name,className:"w-16 h-16 rounded-full mr-4"}),e.jsxs("div",{children:[e.jsx("h2",{className:"font-bold",children:a.otherUser.name}),e.jsx("div",{className:"flex items-center text-xs text-gray-500 mt-1",children:e.jsx("span",{children:(t=a.otheruser)==null?void 0:t.about})})]})]}),e.jsx("input",{type:"checkbox",onChange:()=>We(a.otherUser.uid)})]},a._id)})})}),e.jsxs("div",{className:"mb-l-4 flex",children:[e.jsx("input",{class:"flex  w-full rounded-l-full bg-violet-100 text-xl border-2 border-lite_user p-4 placeholder-lite_user text-black focus:lite_user focus:outline-none focus:ring-2 focus:lite_user",placeholder:"Enter anything...",value:q,onChange:a=>I(a.target.value)}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{disabled:!f.length,onClick:Xe,className:"py-2.5 px-5 ml-l-3 text-sm font-medium text-gray-900 focus:outline-none bg-white rounded-r-full border border-gray-200 hover:bg-gray-100 hover:text-blue-700 focus:z-10 focus:ring-4 focus:ring-gray-100 dark:focus:ring-gray-700 dark:bg-gray-800 dark:text-gray-400 dark:border-gray-600 dark:hover:text-white dark:hover:bg-gray-700",children:"Send "})})]})]})}),e.jsx(P,{isOpen:Ce,onRequestClose:R,className:"fixed inset-0 flex items-center justify-center z-50 mt-[80px]",overlayClassName:"fixed inset-0 bg-black bg-opacity-75",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg w-full max-w-lg mx-auto  overflow-auto scrollbar-hide",children:[e.jsxs("div",{className:"flex justify-between   ",children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"Report"}),e.jsx(_,{onClick:R})]}),e.jsxs("div",{children:[e.jsx("h4",{children:"Select a reason that applies"}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-2"}),e.jsxs("select",{name:"employmentType",value:V,onChange:a=>W(a.target.value),className:"w-full p-2 border rounded",children:[e.jsx("option",{value:"",label:"Select"}),e.jsx("option",{value:"Harassment",label:"Harassment"}),e.jsx("option",{value:"Spam",label:"Spam"}),e.jsx("option",{value:"Hateful speech",label:"Hatefull"}),e.jsx("option",{value:"Sexual content",label:"Sexual content"}),e.jsx("option",{value:"Fake account",label:"Fake account"}),e.jsx("option",{value:"Child exploitation",label:"Child exploitation"}),e.jsx("option",{value:"Other",label:"Other"})]})]}),e.jsx("button",{onClick:ze,className:"text-blue-500 hover:text-blue-900 p-4 bg",children:"Submit"})]})]})})]})};export{ds as C};
